## 算法模块简介

我们的算法模块是一个用于优化仓库分配的系统。该系统利用线性规划来降低成本，同时满足订单需求和仓库库存限制。由于时间限制，尽管我们的代码读取了每个订单的最晚开始时间，但并未将这一因素纳入计算。

### 算法问题

#### 问题背景

在一家大型电商公司中，你作为物流运营经理，需要调度公司的仓库库存以满足客户订单的需求。你的目标是通过智能选择从哪个仓库分配哪个商品给哪个订单，以尽可能降低整体的物流成本。

你需要解决以下问题：对于给定的一系列客户订单，每个订单包含对某种商品的特定需求量以及这个订单的最晚配送完成时间，你需要从公司的多个仓库中选择合适的仓库来满足这些订单。每个仓库都有一定数量的各种商品，以及将这些商品运输到客户的成本。

此问题的难点在于你需要考虑时间的影响。同一仓库同一时间段只能出货同一商品，收到商品到正常使用也有一段时间，但这个问题可以简化为：每个订单都有一个最晚的商品配送完成时间，你需要在这个时间之前完成商品的配送。这就意味着，你不能只考虑成本，还需要考虑时间。

#### 输入与输出

**输入：**

- 订单信息：包括订单编号，提交订单的企业内码，商品内码，商品数量，量纲，最晚商品调配完成时间，仓库信息（包括仓库内码，剖分网盒内码，运输成本）
- 满足度要求
- 调配顺序

**输出：**

- 最优的调配方案，包括仓库内码，企业内码，商品内码，需求时间，成本

#### 案例说明

我们假设有6个订单和2个仓库，每个订单只需要一种产品，每个仓库都有这两种产品。订单和仓库的详细信息如下：

订单信息：

- 订单1：需要产品A 5个单位，最晚完成时间是2023-06-30T00:00:00。
- 订单2：需要产品B 3个单位，最晚完成时间是2023-06-30T00:00:00。
- 订单3：需要产品A 7个单位，最晚完成时间是2023-06-30T00:00:00。
- 订单4：需要产品B 2个单位，最晚完成时间是2023-06-30T00:00:00。
- 订单5：需要产品A 6个单位，最晚完成时间是2023-07-01T00:00:00。
  - 订单6：需要产品B 4个单位，最晚完成时间是2023-07-01T00:00:00。
  
  仓库信息：
  
  - 仓库1：拥有产品A 10个单位，产品B 6个单位，将产品运送到客户的成本是5。
  - 仓库2：拥有产品A 8个单位，产品B 5个单位，将产品运送到客户的成本是3。
  
  此问题的解决方案可能是： 
  
  - 从仓库1发送5个单位的产品A到订单1，3个单位的产品B到订单2。
  - 从仓库2发送7个单位的产品A到订单3，2个单位的产品B到订单4。
  - 从仓库1发送1个单位的产品A和3个单位的产品B到订单6，5个单位的产品A到订单5。
  
  总的来说，我们的算法模块采用了线性规划算法，以优化订单和仓库的匹配，从而达到最小化成本的目标。在考虑订单的需求量和仓库的库存量的同时，我们的模块也考虑了时间限制，虽然我们的代码中并没有具体实现这一部分。

# API 文档

## API 文档概述

本 API 文档详述了我们所开发的一套优化仓库调度与成本控制算法模块的接口定义。该模块设计用于支持进行库存管理和订单配送的企业，以精准控制库存分配和成本管理。

这些接口按照以下两类进行划分：

1. 我们向第三方发出请求的接口，包括 `queryYscb` 和 `ckylcxByUTC` 两个 API。`queryYscb` API 用于查询特定商品从指定仓库至下单公司的总调配成本。`ckylcxByUTC` API 根据协调世界时（UTC）查询仓库的余量。

2. 第三方向我们发出请求的接口，例如 `getZytpcl` API，该接口根据商品订单生成最优的仓库调配策略。在请求参数中，客户端会提供仓库排序信息，无需在处理每个订单时都单独调用接口。

本 API 的设计初衷是实现不同系统和平台之间的无缝集成，以简化库存管理和订单调配的流程。通过运用这些 API，企业可以优化他们的物流过程，有效降低成本并提升效率。

我们期望本文档提供的详细解释与示例能助您更好地利用这些 API。如您有任何进一步的问题或需进行其他修改，欢迎随时与我们取得联系（sudingli@buaa.edu.cn）。

## 1. 查询运输成本（queryYscb）接口

### 描述

查询特定商品从指定仓库至下单公司的总调配成本（包含出库时间和运输成本）。

### HTTP 方法

POST

### URL

http://localhost:8000/sptp/queryYscb

### 请求参数

- cknm：仓库编号
- pfwhnm：货物编号

### 返回结果

返回一个包含运输成本的JSON对象

## 2. 查询仓库库存（ckylcxByUTC）接口

### 描述

根据UTC时间进行仓库余量查询。

### HTTP 方法

POST

### URL

http://localhost:8000/sptp/ckylcxByUTC

### 请求参数

- cknm：仓库编号
- spnm：商品编号
- zwdpwcsj：订单日期

### 返回结果

返回一个包含仓库库存信息的JSON对象

## 3. getZytpcl

### 描述

根据商品订单生成最优仓库调配推荐。现在，客户端会在请求参数中提供仓库排序信息，无需每次处理订单时都调用接口。

### HTTP 方法

POST

### 请求参数

```json
{
   "Spdd

":[
      {
         "ddnm": "订单内码",
         "qynm": "提交商品订单企业内码",
         "spnm": "商品内码",
         "sl": "商品数量",
         "lg": "量纲",
         "zwdpwcsj": "最晚商品调配完成时间",
         "ckdata": [
            {
               "cknm":"仓库内码",
               "pfwhnm":"剖分网盒内码",
               "yscb": "运输成本"
            },
            {
               "cknm":"仓库内码",
               "pfwhnm":"剖分网盒内码",
               "yscb": "运输成本"
            }
            // 以此类推，包含所有仓库信息
         ]
      }
      // 以此类推，包含所有订单信息
   ],
   "spmzd": "商品满足度", 
   "dpsx": "调配顺序"
}
```

### 返回结果

```json
{
   "cknm": "仓库内码",
   "qynm": "企业内码",
   "spnm": "商品内码",
   "xqsj": "需求时间",
   "cb": "成本"
}
```

# 网络环境和URL变化

在实际使用中，我们的系统将在一个不联网的服务器上运行，这可能导致实际部署时的URL与开发时使用的URL不同。因此，我们会在实际部署之前告知新的URL供您使用。

由于服务器不联网，您需要确保在部署系统时，将所有相关的URL更新为适用于实际环境的URL。这包括与其他系统进行通信的URL，如在`get_warehouse_costs`和`get_warehouse_stocks`函数中使用的URL。

请注意，在部署系统之前，您需要确保目标服务器能够访问相关的API或服务，以便能够正常进行通信和获取所需的数据。确保服务器的网络配置和防火墙设置允许与这些API或服务进行通信。

# 接口的版本管理

为了方便在不影响现有系统的前提下进行更新，我们希望通过接口的版本号进行版本管理。通过版本号，您可以在URL中指定所需的接口版本，例如：

```
http://localhost:8000/sptp/v1/queryYscb
```

在上述示例中，我们在URL的路径中指定了版本号`v1`，以区分不同的接口版本。当需要更新接口时，可以引入新的版本号，例如`v2`，并相应地更新URL，例如：

```
http://localhost:8000/sptp/v2/queryYscb
```

这样，您可以根据需要使用不同的接口版本，并且可以同时支持多个版本，以确保兼容性和平滑的系统升级过程。

在进行接口版本管理时，建议使用语义化的版本号命名约定，例如使用`v1.0`、`v1.1`、`v2.0`等。这样可以更好地表达版本之间的兼容性和变更程度。

请在使用接口时确保指定正确的版本号，并在需要更新接口时进行相应的升级和迁移工作，以确保系统的稳定性和可持续发展。

值得注意的是，对接的版本在GitHub上的tag为`v1`，您可以根据需要在GitHub上找到相应的版本标签，并参考相应版本的代码和文档进行开发和部署。

如果您对版本管理有任何疑问或需要进一步的帮助，请随时与我们联系。
